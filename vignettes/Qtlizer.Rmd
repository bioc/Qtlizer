---
title: "Qtlizer"
output: BiocStyle::html_document
author: "Julia Remes & Matthias Munz"
vignette: >
    %\VignetteIndexEntry{Qtlizer}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---


```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>"
)
```

#Introduction 
This package provide access to the Qtlizer database of quantitative trait loci (QTLs) in human. Accepted query terms are variants and genes. The return type is either a data frame or a GRange object.


#Add package to working directory
```{r setup}
library(Qtlizer)
```

#Example function calls
The Qtlizer database can be queried  with the function `get_qtls`: 
```{r}
# Call get_qtls with a variant as a single query term
get_qtls("rs4284742")
```

Multiple terms can be passed in a single string, each term separated by comma, whitespace or both:
```{r}
# Call get_qtls with serveral queries
ddf = get_qtls("rs4284742, rs2070901")
```

Alternatively, terms can be passed as a vector:
```{r}
# Call get_qtls with serveral queries
df = get_qtls(c("rs4284742", "DEFA1"))
```

Input variants can be enriched by variants in linkage disequilibrium (LD). The correlation method to be used can be set with `ld_method`. Default is "r2", alternatively "dprime" can be used. The correlation threshold, above which other correlated variants should be included, can be set with between `corr` and ranges between 0 and 1. Default is "NA"
```{r}
# Use parameters corr and ld_method
df2 = get_qtls(c("rs4284742", "DEFA1"), corr = 0.8, ld_method = "dprime")
```

Also, column descriptions can be viewed:
```{r}
# Get meta info
df = get_qtls("rs4284742")
comment(df)
```

To return the results as GenomicRanges::GRanges object, `return_obj` is set to "grange". If `return_obj` is set to "grange", parameter `ref_version` sets the reference version in which the GRange object is returned. Allowed values are "hg19" (Default).
```{r}
#return result as GRange object with ref_version hg38
g = get_qtls("rs4284742", return_obj = "grange", ref_version = "hg38")
```

#Output of Session Info
The output of ```sessionInfo()``` on the system 
on which this document was compiled: 
```{r}
sessionInfo()
```

